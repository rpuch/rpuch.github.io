---
layout: post
title: XSLT to convert log4j.xml config to logback.xml config
date: '2014-11-24T21:07:00.000+03:00'
author: rpuchkovskiy
tags:
- log4j log4j.xml logback logback.xml convert configuration xslt
modified_time: '2017-03-11T18:34:40.767+03:00'
blogger_id: tag:blogger.com,1999:blog-4160252863216482620.post-6502637392876481691
blogger_orig_url: https://rpuchkovskiy.blogspot.com/2014/11/xslt-to-convert-log4jxml-config-to.html
---

<div class="tr_bq"><a href="http://logback.qos.ch/" target="_blank">Logback</a> is a modern logging framework widely used nowadays. It has a drop-in replacement for a <a href="http://logging.apache.org/log4j/1.2/" target="_blank">log4j 1.2</a> (the previous favorite): logback-classic. But a little problem arises if you have an application which uses log4j and want to migrate it to logback: configuration.</div>log4j has two configuration formats: log4j.properties and log4j.xml. For the former, everything is fine: there is <a href="http://logback.qos.ch/translator/" target="_blank">log4j.properties translator</a> script.<br />But for log4j.xml there doesn't seem to be any convertion tool available, and logback.xml does not understand the unconverted log4j.xml files.<br />So <a href="https://github.com/rpuch/log4j2logback/blob/master/log4j-to-logback.xsl" target="_blank">here</a> is an XSLT which allows to convert log4j.xml files to the corresponding logback.xml configurations.<br />And here is an example. We have the following log4j.xml file:<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br /><br /><span style="color: #007700;">&lt;log4j:configuration</span> <span style="color: #0000cc;">xmlns:log4j=</span><span style="background-color: #fff0f0;">"http://jakarta.apache.org/log4j/"</span><span style="color: #007700;">&gt;</span><br />    <span style="color: #007700;">&lt;appender</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"default"</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"org.apache.log4j.ConsoleAppender"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"target"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"System.out"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;layout</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"org.apache.log4j.PatternLayout"</span><span style="color: #007700;">&gt;</span><br />            <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"ConversionPattern"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"%d %t %p [%c] - %m%n"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;/layout&gt;</span><br />    <span style="color: #007700;">&lt;/appender&gt;</span><br /><br />    <span style="color: #007700;">&lt;appender</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"log4jremote"</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"org.apache.log4j.net.SocketAppender"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"RemoteHost"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"10.0.1.10"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"Port"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"4712"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"ReconnectionDelay"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"10000"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;layout</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"org.apache.log4j.PatternLayout"</span><span style="color: #007700;">&gt;</span><br />            <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"ConversionPattern"</span><br />                   <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"[my-host][%d{ISO8601}]%c{1}%n%m%n"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;/layout&gt;</span><br />        <span style="color: #007700;">&lt;filter</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"org.apache.log4j.varia.LevelRangeFilter"</span><span style="color: #007700;">&gt;</span><br />            <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"LevelMin"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"ERROR"</span><span style="color: #007700;">/&gt;</span><br />            <span style="color: #007700;">&lt;param</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"LevelMax"</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"FATAL"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;/filter&gt;</span><br />    <span style="color: #007700;">&lt;/appender&gt;</span><br /><br />    <span style="color: #007700;">&lt;logger</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"com.somepackage"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;level</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"INFO"</span><span style="color: #007700;">/&gt;</span><br />    <span style="color: #007700;">&lt;/logger&gt;</span><br /><br />    <span style="color: #007700;">&lt;root&gt;</span><br />        <span style="color: #007700;">&lt;level</span> <span style="color: #0000cc;">value=</span><span style="background-color: #fff0f0;">"INFO"</span><span style="color: #007700;">/&gt;</span><br />        <span style="color: #007700;">&lt;appender-ref</span> <span style="color: #0000cc;">ref=</span><span style="background-color: #fff0f0;">"default"</span><span style="color: #007700;">/&gt;</span><br />    <span style="color: #007700;">&lt;/root&gt;</span><br /><span style="color: #007700;">&lt;/log4j:configuration&gt;</span><br /></pre></td></tr></tbody></table></div>Using Xalan to convert it:<br /><br /><blockquote class="tr_bq">java -cp xalan.jar:xercesImpl.jar:serializer.jar:xml-apis.jar org.apache.xalan.xslt.Process -IN log4j.xml -XSL log4j-to-logback.xsl -OUT logback.xml</blockquote><div><br /></div><div>And here is the result:</div><div><br /></div><div><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><table><tbody><tr><td><pre style="line-height: 125%; margin: 0;"> 1<br /> 2<br /> 3<br /> 4<br /> 5<br /> 6<br /> 7<br /> 8<br /> 9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29</pre></td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #557799;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span style="color: #007700;">&lt;configuration</span> <span style="color: #0000cc;">scanPeriod=</span><span style="background-color: #fff0f0;">"10 seconds"</span> <span style="color: #0000cc;">scan=</span><span style="background-color: #fff0f0;">"true"</span><span style="color: #007700;">&gt;</span><br />    <span style="color: #007700;">&lt;appender</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"default"</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"ch.qos.logback.core.ConsoleAppender"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;target&gt;</span>System.out<span style="color: #007700;">&lt;/target&gt;</span><br />        <span style="color: #007700;">&lt;encoder&gt;</span><br />            <span style="color: #007700;">&lt;pattern&gt;</span>%d %t %p [%c] - %m%n<span style="color: #007700;">&lt;/pattern&gt;</span><br />        <span style="color: #007700;">&lt;/encoder&gt;</span><br />    <span style="color: #007700;">&lt;/appender&gt;</span><br /><br /><span style="color: #007700;">&lt;appender</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"log4jremote"</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"ch.qos.logback.classic.net.SocketAppender"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;remoteHost&gt;</span>10.0.1.10<span style="color: #007700;">&lt;/remoteHost&gt;</span><br />        <span style="color: #007700;">&lt;port&gt;</span>4712<span style="color: #007700;">&lt;/port&gt;</span><br />        <span style="color: #007700;">&lt;reconnectionDelay&gt;</span>10000<span style="color: #007700;">&lt;/reconnectionDelay&gt;</span><br />        <span style="color: #888888;">&lt;!-- this is NOT needed tor this logger, so it is commented out --&gt;</span><br />        <span style="color: #888888;">&lt;!--</span><br /><span style="color: #888888;">        &lt;layout&gt;</span><br /><span style="color: #888888;">            &lt;pattern&gt;[my-host][%d{ISO8601}]%c{1}%n%m%n&lt;/pattern&gt;</span><br /><span style="color: #888888;">        &lt;/layout&gt;</span><br /><span style="color: #888888;">                    --&gt;</span><br />        <span style="color: #007700;">&lt;filter</span> <span style="color: #0000cc;">class=</span><span style="background-color: #fff0f0;">"ch.qos.logback.classic.filter.ThresholdFilter"</span><span style="color: #007700;">&gt;</span><br />            <span style="color: #007700;">&lt;level&gt;</span>ERROR<span style="color: #007700;">&lt;/level&gt;</span><br />        <span style="color: #007700;">&lt;/filter&gt;</span><br />    <span style="color: #007700;">&lt;/appender&gt;</span><br /><br /><span style="color: #007700;">&lt;logger</span> <span style="color: #0000cc;">name=</span><span style="background-color: #fff0f0;">"com.somepackage"</span> <span style="color: #0000cc;">level=</span><span style="background-color: #fff0f0;">"INFO"</span><span style="color: #007700;">/&gt;</span><br /><br /><span style="color: #007700;">&lt;root</span> <span style="color: #0000cc;">level=</span><span style="background-color: #fff0f0;">"INFO"</span><span style="color: #007700;">&gt;</span><br />        <span style="color: #007700;">&lt;appender-ref</span> <span style="color: #0000cc;">ref=</span><span style="background-color: #fff0f0;">"default"</span><span style="color: #007700;">/&gt;</span><br />    <span style="color: #007700;">&lt;/root&gt;</span><br /><span style="color: #007700;">&lt;/configuration&gt;</span><br /></pre></td></tr></tbody></table></div></div><div><br /></div><div>The script translates the basic loggers (console/email/file/syslog/socket).<br /><br />Here is github repository:&nbsp;<a target="_blank" href="https://github.com/rpuch/log4j2logback">https://github.com/rpuch/log4j2logback</a></div>